#!/usr/bin/env bash
# Script to restart gunicorn service gracefully
# Closes the workers one by one after they complete
# pending request then restarts them

gunicorn_pids=$(pgrep gunicorn)

# Check if Gunicorn instances are running
if [ -n "$gunicorn_pids" ]; then
    # Send graceful reload signal to each Gunicorn instance
    for pid in $gunicorn_pids; do
        kill -s HUP "$pid"
    done
    echo "Gunicorn reloaded gracefully."
else
    echo "No Gunicorn instances found running."
fi
