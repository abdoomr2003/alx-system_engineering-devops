#!/usr/bin/env bash
# This script gracefully reloads Gunicorn workers without causing downtime.

# Get the PID of the Gunicorn master process
MASTER_PID=$(ps aux | grep '[g]unicorn' | awk '{print $2}')

# Check if the master process is running
if [ -z "$MASTER_PID" ]; then
    echo "Gunicorn master process is not running."
    exit 1
fi

# Send a HUP signal to the Gunicorn master process to gracefully reload workers
kill -HUP $MASTER_PID

echo "Gunicorn master process has been instructed to reload workers gracefully."
