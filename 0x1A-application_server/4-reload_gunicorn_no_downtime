#!/usr/bin/env bash
# Script to restart gunicorn service gracefully
# Closes the workers one by one after they complete
# pending request then restarts them

master_pid=$(pgrep -f gunicorn | head -1)

# Check if the master_pid variable is set and not empty
if [ -n "$master_pid" ]; then
    # If the master_pid variable is set and not empty,
    # send the HUP signal to the Gunicorn master process
    kill -HUP "$master_pid"
else
    # If the master_pid variable is not set or empty, print an error message
    echo "Error: Could not find the Gunicorn master process."
fi
